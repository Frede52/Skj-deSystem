@page "/apartments"
@using SkjødeSystem.Models
@inject NavigationManager NavigationManager

<PageTitle>Apartments</PageTitle>

<h3>Apartments</h3>

<table class="table table-striped">
    <thead>
        <tr>
            <th>ApartmentId</th>
            <th>Address</th>
            <th>Status</th>
            <th>Create Task</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var apartment in apartments)
        {
            <tr>
                <td>@apartment.ApartmentId</td>
                <td>@apartment.Address</td>
                <td>
                    <InputSelect class="form-control" style="width: 110px; height: auto" @bind-Value="apartment.Status">
                        @foreach (var status in Statuses)
                        {
                            <option value="@status">@status</option>
                        }
                    </InputSelect>
                </td>
                <td>
                    <button class="btn btn-primary" 
                            @onclick="() => NavigateToCreateTask(apartment.ApartmentId)" 
                            disabled="@IsStatusComplete(apartment.Status)">
                        Create Task
                    </button>
                </td>
            </tr>
        }
    </tbody>
</table>

@code {
    private List<Apartment> apartments = new List<Apartment>
    {
        new Apartment { ApartmentId = 1, Address = "Sønderhøj 30", Status = "Incomplete" },
        new Apartment { ApartmentId = 2, Address = "Bryggerivej 23", Status = "Incomplete" },
        new Apartment { ApartmentId = 3, Address = "Fasanvej 99", Status = "Incomplete" }
    };

    private List<string> Statuses = new List<string> { "Incomplete", "Complete" };

    private void NavigateToCreateTask(int apartmentId)
    {
        NavigationManager.NavigateTo($"/createtask/{apartmentId}");
    }

    private bool IsStatusComplete(string status)
    {
        return status == "Complete";
    }
}